Extract From Website
====================

This script extracts the weekly deals from pickapart.ca and compares them with a
watchlist defined in the "products-to-look-for" file. If it finds that you
watchlisted items are on sale in the following week it will email you which ones
they are (defined in the "emails" file).

Sample Output
-------------

See "example.md" in the repo for a sample of the markdown file output.

### Note:

This is the markdown generated by the script pasted into the readme. As a
result, this will be formatted slightly differently to the actual pdf since
gimli is not exactly the same as the output of github for markdown.



Debug
-----

Execute the debug script, and the script will only email the message to the
first email address in the "emails" file (usually this would be your email), and
will not delete any of the files that are generated by the script, so that you
can analyze the files and figure out what is happening.

Emails File
-----------

Just list each email address that will receive the email on a separate line.

This file also allows comments

sample:

```
# Comment
user1@domain.com
user2@domain.com
user3@domain.com
```

Products to look for File
-------------------------

Just list each item on a separate line.

This file also allows comments

sample:

```
# Comment
Any Plain Steel Wheels
Car Doors
Hoods
```

Note: It will also find fragments, so:

```
Steel Wheels
```

Will search for anything that contains "Steel Wheels", which includes the first
item on the sample list.

Note: This file is case insensitive.

tdtags and old-tdtags file
--------------------------

Both generated by the script

tdtags is populated based on the newest data from the website.

old-tdtags is a copy of tdtags before tdtags is populated with the new data (ie.
old-tdtags has all the data from the last execution, and tdtags has all the data
from the latest exectution).

We need both so that they can be compared to find out if a car has been added,
or removed from inventory.

Cars that have been added or removed are attached in the email with all the
details of the car.

Cars-to-find
------------

Is a newline separated list of cars to search for. The entries must match the
value variable of the car you want. The value variables can be found
[here](view-source:http://parts.pickapart.ca/).

Cronjob
-------

create a new cronjob by executing this:

```bash
crontab -e
```

and enter the below.

Since this website updates its page with new "on sale items" every week on
Fridays at 6pm, use the following cronjob settings in order to run this:

```bash
0 18 * * 5 /PATH/TO/extract-from-pick-a-part
```

Note: 0 is the minute of the day, 18 is the hour of the day (18 is 6pm), * means
any day of the month, * means any month, 5 means Fridays. Therefore the script
runs every Friday at 6pm.

Also, the car inventory is updated on an hourly basis during business hours, so
add this cronjob to run the script only for the car portion (no sale items)
every day except Friday:

```bash
0 * * * 0,1,2,3,4,6 /PATH/TO/extract-from-pick-a-part --cars-only
0 0-17,19-23 * * 5 /PATH/TO/extract-from-pick-a-part --cars-only
```

This runs every day at 1:02pm, and every day except friday at 7:00pm. It does
not execute on Friday, because that is covered by the example before this
example. I chose 1:02pm to give the website 2 minutes to update, and 1:02pm is
close to the middle of the work day at Pick a Part.

0 *          = Every Hour on the hour
\*           = Any day of the month
\*           = Any Month
0,1,2,3,4,6 = Sunday, Monday, Tuesday, Wednesday, Thursday, or Saturday

0 0-17,19-23 = Every Hour on the hour except for 18:00 (6pm)
\*           = Any day of the month
\*           = Any Month
5            = Friday only.

Friday's I want to skip 18:00, because it gets run from the first crontab line
anyways at this time.

Note that the car part will still run on friday as per the previous cronjob
task, but it will also check for on sale items.

